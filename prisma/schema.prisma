
datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

model Company {
  id        String   @id @default(cuid())
  name      String
  currency  String   @default("USD")
  users     User[]
  expenses  Expense[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model User {
  id             String    @id @default(cuid())
  name           String
  email          String    @unique
  passwordHash   String
  role           Role      @default(EMPLOYEE)
  company        Company   @relation(fields: [companyId], references: [id])
  companyId      String
  expenses       Expense[]
  manager        User?     @relation("ManagerTeam", fields: [managerId], references: [id])
  managerId      String?
  teamMembers    User[]    @relation("ManagerTeam")
  isManagerApprover Boolean @default(false)
  createdAt      DateTime  @default(now())
}

model Expense {
  id                       String   @id @default(cuid())
  user                     User     @relation(fields: [userId], references: [id])
  userId                   String
  company                  Company  @relation(fields- [companyId], references: [id])
  companyId                String
  amount                   Float
  currency                 String
  amountInCompanyCurrency  Float
  category                 String
  date                     DateTime
  description              String?
  vendor                   String
  receiptUrl               String?
  status                   Status   @default(PENDING)
  createdAt                DateTime @default(now())
  updatedAt                DateTime @updatedAt
}

enum Role {
  ADMIN
  MANAGER
  EMPLOYEE
}

enum Status {
  PENDING
  APPROVED
  REJECTED
}
